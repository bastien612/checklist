const assert = require('assert');
const { Given, When, Then } = require('cucumber');
const webdriver = require("selenium-webdriver");

(async function test() {
    
    Given('I am on the Google search page', function () {
        this.driver = await new webdriver.Builder().forBrowser('chrome').build();
        await this.driver.get('http://www.google.com');
    });
    
    When('I search for {string}', function (searchTerm) {
        let element = await this.driver.findElement(webdriver.By.name('q'));
        await element.sendKeys('Cheese!');
        await element.submit();
    });
    
    Then('the page title should start with {string}', function (expectedAnswer) {
        try {
            // await driver.wait(until.titleIs('webdriver - Google Search'), 1000);
    
            // this.driver.getTitle().then(function (title) {
            //     console.log('Page title is: ' + title);
            // });
        
            // this.driver.wait(function () {
            //     return this.driver.getTitle().then(function (title) {
            //         return title.toLowerCase().lastIndexOf('cheese!', 0) === 0;
            //     });
            // }, 3000);
        
            this.driver.getTitle().then(function (title) {
                console.log('Page title is: ' + title);
                assert.equal(title, "cheese! - Google Search");
            });
        } finally {
            this.driver.quit();
        }
    });
}




